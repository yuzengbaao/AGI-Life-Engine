# AGI è®°å¿†ä¿æŠ¤ä¸æ¢å¤æ–¹æ¡ˆ

## ğŸ“Š å½“å‰è®°å¿†ç³»ç»ŸçŠ¶æ€

### è®°å¿†ç±»å‹ä¸å­˜å‚¨ä½ç½®

| è®°å¿†ç±»å‹ | å­˜å‚¨ä½ç½® | å½“å‰çŠ¶æ€ | å¤‡ä»½çŠ¶æ€ |
|---------|---------|---------|---------|
| **å‘é‡è®°å¿†** | `memory/vector_memory.json` | âœ… å­˜åœ¨ | âœ… æœ‰å¤‡ä»½ |
| **å¯¹è¯å†å²** | `memory/agi_text_memory.db` | âœ… å­˜åœ¨ | âš ï¸ éœ€è¦å¤‡ä»½ |
| **å…ƒè®¤çŸ¥å†å²** | `memory/metacognition_history.json` | âœ… å­˜åœ¨ | âš ï¸ éœ€è¦å¤‡ä»½ |
| **é•¿æœŸæ´å¯Ÿ** | `memory/long_term_insights.md` | âœ… å­˜åœ¨ | âš ï¸ éœ€è¦å¤‡ä»½ |

### å¯ç”¨å¤‡ä»½

#### å‘é‡è®°å¿†å¤‡ä»½
- `memory/backups/vector_memory_20260126_195058.json` (2026-01-26 19:50:58)
- `memory/backups/vector_memory_20260126_210111.json` (2026-01-26 21:01:11)
- `memory/vector_memory.json.backup` (æ‰‹åŠ¨å¤‡ä»½)

## ğŸ”„ æ˜¯å¦éœ€è¦æ¢å¤è®°å¿†ï¼Ÿ

### è¯„ä¼°æ ‡å‡†

**å»ºè®®æ¢å¤çš„æƒ…å†µ**ï¼š
1. âœ… ç³»ç»Ÿè¯¯åˆ é™¤äº†é‡è¦è®°å¿†
2. âœ… è®°å¿†æ–‡ä»¶æŸåæˆ–æ ¼å¼é”™è¯¯
3. âœ… éœ€è¦å›é€€åˆ°ç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€
4. âœ… ç³»ç»Ÿå‡çº§å‰çš„å®Œæ•´å¤‡ä»½éªŒè¯

**ä¸å»ºè®®æ¢å¤çš„æƒ…å†µ**ï¼š
1. âŒ åªæ˜¯æ¸…ç†äº†æ—§çš„æµ‹è¯•è®°å½•ï¼ˆå¦‚ 2end.txtï¼‰
2. âŒ å½“å‰ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼Œè®°å¿†å®Œæ•´
3. âŒ å¤‡ä»½æ—¶é—´è¿‡æ—§ï¼ˆè¶…è¿‡30å¤©ï¼‰

### å½“å‰è¯„ä¼°

åŸºäºå½“å‰æƒ…å†µåˆ†æï¼š

| è¯„ä¼°é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| å‘é‡è®°å¿†å®Œæ•´æ€§ | âœ… è‰¯å¥½ | å½“å‰æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡® |
| å¯¹è¯å†å²å®Œæ•´æ€§ | âœ… è‰¯å¥½ | æ•°æ®åº“æ­£å¸¸ï¼Œå·²æ¸…ç©ºæ—§è®°å½• |
| å¤‡ä»½å¯ç”¨æ€§ | âœ… è‰¯å¥½ | æœ‰å¤šä¸ªæ—¶é—´ç‚¹çš„å¤‡ä»½ |
| æ¢å¤å¿…è¦æ€§ | âŒ ä¸éœ€è¦ | å½“å‰è®°å¿†ç³»ç»Ÿè¿è¡Œæ­£å¸¸ |

**ç»“è®º**ï¼š**ä¸éœ€è¦æ¢å¤è®°å¿†**ã€‚å½“å‰è®°å¿†ç³»ç»ŸçŠ¶æ€è‰¯å¥½ï¼Œæ¸…ç†çš„åªæ˜¯æ—§çš„æµ‹è¯•è®°å½•ï¼Œä¸å½±å“ç³»ç»Ÿæ ¸å¿ƒè®°å¿†ã€‚

## ğŸ› ï¸ è®°å¿†æ¢å¤æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨æ¢å¤å·¥å…·ï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œæ¢å¤å·¥å…·
python restore_memory.py
```

å·¥å…·ä¼šï¼š
1. åˆ—å‡ºæ‰€æœ‰å¯ç”¨å¤‡ä»½
2. è®©ä½ é€‰æ‹©è¦æ¢å¤çš„å¤‡ä»½
3. è‡ªåŠ¨åˆ›å»ºå½“å‰æ–‡ä»¶çš„å¤‡ä»½
4. æ‰§è¡Œæ¢å¤æ“ä½œ
5. éªŒè¯æ¢å¤ç»“æœ

### æ–¹æ³•2: æ‰‹åŠ¨æ¢å¤

#### æ¢å¤å‘é‡è®°å¿†
```bash
# 1. å¤‡ä»½å½“å‰æ–‡ä»¶
cp memory/vector_memory.json memory/vector_memory.json.backup_$(date +%Y%m%d_%H%M%S)

# 2. æ¢å¤å¤‡ä»½
cp memory/backups/vector_memory_20260126_195058.json memory/vector_memory.json

# 3. éªŒè¯
python -c "import json; print(json.load(open('memory/vector_memory.json'))['documents'][:2])"
```

#### æ¢å¤å¯¹è¯å†å²
```bash
# 1. å¤‡ä»½å½“å‰æ•°æ®åº“
cp memory/agi_text_memory.db memory/agi_text_memory.db.backup_$(date +%Y%m%d_%H%M%S)

# 2. æ¢å¤å¤‡ä»½æ•°æ®åº“
cp <å¤‡ä»½è·¯å¾„>/agi_text_memory.db memory/agi_text_memory.db

# 3. éªŒè¯
python -c "import sqlite3; conn = sqlite3.connect('memory/agi_text_memory.db'); print(conn.execute('SELECT COUNT(*) FROM context_history').fetchone())"
```

## ğŸ›¡ï¸ æœªæ¥è®°å¿†ä¿æŠ¤æ–¹æ¡ˆ

### 1. è‡ªåŠ¨å¤‡ä»½ç­–ç•¥

#### å®šæœŸå¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰
```python
# æ·»åŠ åˆ° AGI_Life_Engine.py æˆ–ç³»ç»Ÿå¯åŠ¨è„šæœ¬
import shutil
from datetime import datetime

def backup_memory():
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    # å¤‡ä»½å‘é‡è®°å¿†
    shutil.copy("memory/vector_memory.json", f"memory/backups/vector_memory_{timestamp}.json")
    
    # å¤‡ä»½å¯¹è¯å†å²
    shutil.copy("memory/agi_text_memory.db", f"memory/backups/agi_text_memory_{timestamp}.db")
    
    # å¤‡ä»½å…ƒè®¤çŸ¥å†å²
    shutil.copy("memory/metacognition_history.json", f"memory/backups/metacognition_{timestamp}.json")
    
    # æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘7å¤©ï¼‰
    cleanup_old_backups(days=7)

def cleanup_old_backups(days=7):
    import os
    from datetime import datetime, timedelta
    
    cutoff = datetime.now() - timedelta(days=days)
    backup_dir = Path("memory/backups")
    
    for file in backup_dir.glob("*"):
        if file.is_file():
            mtime = datetime.fromtimestamp(file.stat().st_mtime)
            if mtime < cutoff:
                file.unlink()
                print(f"æ¸…ç†æ—§å¤‡ä»½: {file.name}")
```

#### å…³é”®æ“ä½œå‰å¤‡ä»½
```python
# åœ¨æ‰§è¡Œå…³é”®æ“ä½œå‰è‡ªåŠ¨åˆ›å»ºå¤‡ä»½
def pre_operation_backup(operation_name: str):
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    # åˆ›å»ºå¿«ç…§
    snapshot_dir = Path(f"memory/snapshots/{operation_name}_{timestamp}")
    snapshot_dir.mkdir(parents=True, exist_ok=True)
    
    shutil.copy("memory/vector_memory.json", snapshot_dir / "vector_memory.json")
    shutil.copy("memory/agi_text_memory.db", snapshot_dir / "agi_text_memory.db")
    shutil.copy("memory/metacognition_history.json", snapshot_dir / "metacognition_history.json")
    
    return snapshot_dir
```

### 2. è®°å¿†å®Œæ•´æ€§éªŒè¯

#### è‡ªåŠ¨éªŒè¯è„šæœ¬
```python
def validate_memory_integrity():
    """éªŒè¯è®°å¿†ç³»ç»Ÿçš„å®Œæ•´æ€§"""
    issues = []
    
    # 1. æ£€æŸ¥å‘é‡è®°å¿†
    try:
        with open("memory/vector_memory.json", 'r') as f:
            data = json.load(f)
            if 'documents' not in data:
                issues.append("å‘é‡è®°å¿†ç¼ºå°‘ 'documents' å­—æ®µ")
            if not isinstance(data['documents'], list):
                issues.append("å‘é‡è®°å¿† 'documents' ä¸æ˜¯åˆ—è¡¨")
    except Exception as e:
        issues.append(f"å‘é‡è®°å¿†è¯»å–å¤±è´¥: {e}")
    
    # 2. æ£€æŸ¥å¯¹è¯å†å²
    try:
        import sqlite3
        conn = sqlite3.connect("memory/agi_text_memory.db")
        cursor = conn.cursor()
        
        # æ£€æŸ¥è¡¨ç»“æ„
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
        tables = [row[0] for row in cursor.fetchall()]
        if 'context_history' not in tables:
            issues.append("å¯¹è¯å†å²ç¼ºå°‘ 'context_history' è¡¨")
        
        # æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
        cursor.execute("SELECT COUNT(*) FROM context_history")
        count = cursor.fetchone()[0]
        if count == 0:
            issues.append("å¯¹è¯å†å²ä¸ºç©º")
        
        conn.close()
    except Exception as e:
        issues.append(f"å¯¹è¯å†å²éªŒè¯å¤±è´¥: {e}")
    
    # 3. æ£€æŸ¥å…ƒè®¤çŸ¥å†å²
    try:
        with open("memory/metacognition_history.json", 'r') as f:
            data = json.load(f)
            if not isinstance(data, list):
                issues.append("å…ƒè®¤çŸ¥å†å²æ ¼å¼é”™è¯¯")
    except Exception as e:
        issues.append(f"å…ƒè®¤çŸ¥å†å²è¯»å–å¤±è´¥: {e}")
    
    return issues

# åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œ
issues = validate_memory_integrity()
if issues:
    print("âš ï¸ è®°å¿†å®Œæ•´æ€§é—®é¢˜:")
    for issue in issues:
        print(f"  - {issue}")
else:
    print("âœ… è®°å¿†ç³»ç»Ÿå®Œæ•´æ€§éªŒè¯é€šè¿‡")
```

### 3. ç‰ˆæœ¬æ§åˆ¶é›†æˆ

#### Git è¿½è¸ªå…³é”®è®°å¿†æ–‡ä»¶
```bash
# å°†å…³é”®è®°å¿†æ–‡ä»¶æ·»åŠ åˆ° Git
git add memory/vector_memory.json
git add memory/agi_text_memory.db
git add memory/metacognition_history.json
git add memory/long_term_insights.md

# åˆ›å»ºè®°å¿†ç‰ˆæœ¬æ ‡ç­¾
git tag -a "memory-$(date +%Y%m%d-%H%M%S)" -m "Memory snapshot"
```

#### è‡ªåŠ¨æäº¤è„šæœ¬
```python
def commit_memory_changes():
    """è‡ªåŠ¨æäº¤è®°å¿†å˜æ›´"""
    import subprocess
    
    # æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´
    result = subprocess.run(
        ['git', 'status', '--porcelain', 'memory/'],
        capture_output=True,
        text=True
    )
    
    if result.stdout.strip():
        # æœ‰å˜æ›´ï¼Œæäº¤
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        subprocess.run([
            'git', 'commit', '-m',
            f"Memory update: {timestamp}"
        ])
        
        # åˆ›å»ºæ ‡ç­¾
        subprocess.run([
            'git', 'tag', '-a',
            f"memory-{timestamp.replace(':', '').replace(' ', '-')}",
            '-m', f"Memory snapshot at {timestamp}"
        ])
        
        print(f"âœ… è®°å¿†å˜æ›´å·²æäº¤: {timestamp}")
    else:
        print("â„¹ï¸  æ— è®°å¿†å˜æ›´")
```

### 4. ç¾éš¾æ¢å¤è®¡åˆ’

#### å¤‡ä»½å­˜å‚¨ç­–ç•¥
```
æœ¬åœ°å¤‡ä»½ï¼ˆå¿«é€Ÿæ¢å¤ï¼‰:
- memory/backups/          # æœ€è¿‘7å¤©çš„å¤‡ä»½
- memory/snapshots/         # å…³é”®æ“ä½œå¿«ç…§

è¿œç¨‹å¤‡ä»½ï¼ˆé•¿æœŸå­˜å‚¨ï¼‰:
- äº‘å­˜å‚¨æœåŠ¡ï¼ˆå¦‚ AWS S3, Azure Blobï¼‰
- Git ä»“åº“
- å®šæœŸå¯¼å‡ºåˆ°å¤–éƒ¨é©±åŠ¨å™¨
```

#### æ¢å¤ä¼˜å…ˆçº§
```
ä¼˜å…ˆçº§ 1: æœ€æ–°å¿«ç…§ï¼ˆmemory/snapshots/æœ€æ–°ï¼‰
ä¼˜å…ˆçº§ 2: æ˜¨æ—¥å¤‡ä»½ï¼ˆmemory/backups/æ˜¨å¤©ï¼‰
ä¼˜å…ˆçº§ 3: æœ¬å‘¨å¤‡ä»½ï¼ˆmemory/backups/æœ¬å‘¨ï¼‰
ä¼˜å…ˆçº§ 4: è¿œç¨‹å¤‡ä»½ï¼ˆäº‘å­˜å‚¨/Gitï¼‰
```

## ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•

### ç«‹å³å®æ–½ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
- [x] åˆ›å»ºè®°å¿†æ¢å¤å·¥å…· (`restore_memory.py`)
- [ ] é…ç½®æ¯æ—¥è‡ªåŠ¨å¤‡ä»½
- [ ] æ·»åŠ å¯åŠ¨æ—¶è®°å¿†å®Œæ•´æ€§éªŒè¯
- [ ] åˆ›å»ºå¤‡ä»½ç›®å½•ç»“æ„

### çŸ­æœŸå®æ–½ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
- [ ] é›†æˆ Git ç‰ˆæœ¬æ§åˆ¶
- [ ] é…ç½®è¿œç¨‹å¤‡ä»½åˆ°äº‘å­˜å‚¨
- [ ] åˆ›å»ºå¤‡ä»½ç›‘æ§å’Œå‘Šè­¦
- [ ] ç¼–å†™å¤‡ä»½æ¢å¤æµ‹è¯•è„šæœ¬

### é•¿æœŸå®æ–½ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
- [ ] å®ç°è®°å¿†å‹ç¼©å’Œå½’æ¡£
- [ ] å¼€å‘è®°å¿†è¿ç§»å·¥å…·
- [ ] åˆ›å»ºè®°å¿†åˆ†æä»ªè¡¨æ¿
- [ ] å®ç°è·¨ç³»ç»Ÿè®°å¿†åŒæ­¥

## ğŸ”§ ä½¿ç”¨å»ºè®®

### æ—¥å¸¸ä½¿ç”¨
1. **å®šæœŸæ£€æŸ¥å¤‡ä»½**ï¼šæ¯å‘¨æ£€æŸ¥ä¸€æ¬¡å¤‡ä»½å®Œæ•´æ€§
2. **æµ‹è¯•æ¢å¤æµç¨‹**ï¼šæ¯æœˆæµ‹è¯•ä¸€æ¬¡æ¢å¤æµç¨‹
3. **ç›‘æ§å­˜å‚¨ç©ºé—´**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
4. **è®°å½•é‡è¦æ“ä½œ**ï¼šåœ¨æ‰§è¡Œå…³é”®æ“ä½œå‰åˆ›å»ºå¿«ç…§

### åº”æ€¥æƒ…å†µ
1. **ç«‹å³åœæ­¢ç³»ç»Ÿ**ï¼šé˜²æ­¢è¿›ä¸€æ­¥çš„æ•°æ®æŸå
2. **è¯„ä¼°æŸå¤±èŒƒå›´**ï¼šç¡®å®šå“ªäº›è®°å¿†å—å½±å“
3. **é€‰æ‹©æœ€ä½³å¤‡ä»½**ï¼šé€‰æ‹©æœ€è¿‘ä¸”å®Œæ•´çš„å¤‡ä»½
4. **éªŒè¯æ¢å¤ç»“æœ**ï¼šç¡®ä¿æ¢å¤åç³»ç»Ÿæ­£å¸¸è¿è¡Œ
5. **æ›´æ–°ä¿æŠ¤æªæ–½**ï¼šæ ¹æ®é—®é¢˜è°ƒæ•´å¤‡ä»½ç­–ç•¥

## ğŸ“ æ€»ç»“

### å½“å‰çŠ¶æ€
- âœ… è®°å¿†ç³»ç»Ÿè¿è¡Œæ­£å¸¸
- âœ… æœ‰å¯ç”¨çš„å¤‡ä»½
- âœ… å¤‡ä»½å·¥å…·å·²å‡†å¤‡å°±ç»ª
- âš ï¸ å»ºè®®å®æ–½è‡ªåŠ¨å¤‡ä»½ç­–ç•¥

### è¡ŒåŠ¨å»ºè®®
1. **çŸ­æœŸ**ï¼šé…ç½®æ¯æ—¥è‡ªåŠ¨å¤‡ä»½
2. **ä¸­æœŸ**ï¼šé›†æˆç‰ˆæœ¬æ§åˆ¶å’Œè¿œç¨‹å¤‡ä»½
3. **é•¿æœŸ**ï¼šå®ç°å®Œæ•´çš„è®°å¿†ç®¡ç†ç³»ç»Ÿ

### é£é™©æç¤º
- âš ï¸ å®šæœŸæ¸…ç†æ—§å¤‡ä»½ä»¥èŠ‚çœç©ºé—´
- âš ï¸ æµ‹è¯•æ¢å¤æµç¨‹ç¡®ä¿å¤‡ä»½å¯ç”¨
- âš ï¸ ç›‘æ§å¤‡ä»½å­˜å‚¨çš„å¥åº·çŠ¶æ€
- âš ï¸ ä¿æŒå¤‡ä»½çš„åŠ å¯†å’Œè®¿é—®æ§åˆ¶
